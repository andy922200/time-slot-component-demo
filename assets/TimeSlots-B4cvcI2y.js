import{d as S,r as v,c as k,o as w,O as B,b as m,e as r,F as $,f as x,i as u,n as j,j as H,p as V,a as _,t as y,w as A,h as E,k as F}from"./index-BN4XCwYM.js";import"./index-CSaXsr8O.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"time-slot mb-6 mt-2 w-full px-4"},O={class:"flex w-full items-center rounded shadow-[0_0_8px_rgba(0,0,0,0.1)]"},P=["data-text"],N={key:0,class:"after-line top-1.5 h-3"},W=S({name:"TimeSlots",__name:"index",props:{lineColor:{default:"#cdcdcd"},textColor:{default:"#000000"},timeSlotInterval:{default:15},minLabelSpacing:{default:30},targetDate:{},dataIntervals:{default:()=>[]},slotClass:{default:()=>({disabled:"!border-y-gray-400 !bg-gray-400",used:"!border-y-[#fdeadb] !bg-[#fdeadb]",past:"opacity-60",normal:"border-y-white bg-white"})}},setup(M,{expose:n}){const e=M,f=v([]),p=k(()=>e.targetDate?i(e.dataIntervals):[]),d=()=>{const s=document.querySelector(".time-slot"),t=document.querySelectorAll(".time-cell");if(s&&t.length>0){const a=s.clientWidth,o=Math.floor(a/e.minLabelSpacing),c=[];for(let l=0;l<24;l++)l%Math.ceil(24/o)===0&&c.push(l);f.value=c}},D=s=>{const t=60/e.timeSlotInterval,a=Math.floor(s/t);return s%t*e.timeSlotInterval===0&&f.value.includes(a)},h=(s,t,a)=>{let o=!1,c=!1;return a.forEach(l=>{if(l.date!==e.targetDate)return;const Y=_(`${l.date} ${l.start}`,"YYYY-MM-DD HH:mm"),b=_(`${l.date} ${l.end}`,"YYYY-MM-DD HH:mm");t.isAfter(Y,"minute")&&s.isBefore(b,"minute")&&(l.type==="used"&&(o=!0),l.type==="disabled"&&(c=!0))}),{isUsed:o,isDisabled:c}},i=s=>{const t=[],a=_(e.targetDate).startOf("day"),o=e.timeSlotInterval,c=24*60,l=_();for(let Y=0;Y<c;Y+=o){const b=a.add(Y,"minute"),g=b.add(o,"minute"),C=b.format("HH:mm"),{isUsed:I,isDisabled:L}=h(b,g,s),T=g.isSameOrBefore(l,"minute");t.push({time:C,isUsed:I,isPast:T,isDisabled:L})}return t};return w(()=>{window.addEventListener("resize",d),d()}),B(()=>{window.removeEventListener("resize",d)}),n({visibleLabels:f}),(s,t)=>(u(),m("div",z,[r("div",O,[(u(!0),m($,null,x(p.value,(a,o)=>(u(),m("div",{key:o,"data-text":D(o)?a.time.split(":")[0]:"",class:j(["time-cell relative h-6 flex-1",a.isDisabled?`cursor-not-allowed ${e.slotClass.disabled}`:"",a.isUsed?`${e.slotClass.used}`:`${e.slotClass.normal}`,a.isPast?`${e.slotClass.past}`:"",o===0?"no-shadow rounded-l":"",o===p.value.length-1?"no-shadow rounded-r":""]),style:H({"--time-slot__line-color":a.isUsed?"#fff":a.isDisabled?"#9Ca3Af":e.lineColor,"--time-slot__text-color":e.textColor})},[a.time.endsWith(":00")&&o!==0?(u(),m("span",N)):V("",!0)],14,P))),128))])]))}}),q=U(W,[["__scopeId","data-v-1f896d2b"]]),G={class:"w-full"},J={class:"flex items-center justify-center"},K={class:"m-2"},Q={class:"flex items-center justify-center"},R={class:"m-2"},X={for:"date-picker"},Z={class:"flex items-center justify-center"},at=S({name:"DemoTimeSlots",__name:"TimeSlots",setup(M){const n=_(),e=n.subtract(1,"day"),f=n.add(1,"day"),p=v(n.format("YYYY-MM-DD")),d=v([]),D=async()=>(await new Promise(i=>setTimeout(i,1e3)),[{date:e.format("YYYY-MM-DD"),start:"08:00",end:"09:30",type:"disabled"},{date:e.format("YYYY-MM-DD"),start:"12:17",end:"17:38",type:"used"},{date:n.format("YYYY-MM-DD"),start:"00:00",end:"02:00",type:"used"},{date:n.format("YYYY-MM-DD"),start:"02:00",end:"02:30",type:"disabled"},{date:n.format("YYYY-MM-DD"),start:"16:17",end:"18:38",type:"used"},{date:n.format("YYYY-MM-DD"),start:"22:00",end:"22:40",type:"disabled"},{date:f.format("YYYY-MM-DD"),start:"10:00",end:"16:30",type:"disabled"},{date:f.format("YYYY-MM-DD"),start:"20:17",end:"22:38",type:"used"}]),h={disabled:"!border-y-gray-600 !bg-gray-600",used:"!border-y-[#FF4500] !bg-[#FF4500]",past:"opacity-60",normal:"border-y-white bg-white"};return w(async()=>{d.value=await D()}),(i,s)=>(u(),m("div",G,[s[1]||(s[1]=r("h1",{class:"text-center text-lg"},"TimeSlots 時間間隔顯示",-1)),r("div",J,[r("h3",K,y(i.$t("used-time-slots")),1),r("ul",null,[(u(!0),m($,null,x(d.value,t=>(u(),m("li",{key:t.start},[r("p",null,y(t.date)+" "+y(t.start)+" ~ "+y(t.end)+" : "+y(i.$t(t.type)),1)]))),128))])]),r("div",Q,[r("div",R,[r("label",X,y(i.$t("date"))+"：",1),A(r("input",{id:"date-picker","onUpdate:modelValue":s[0]||(s[0]=t=>p.value=t),type:"date"},null,512),[[E,p.value]])])]),r("div",Z,[F(q,{class:"w-full","text-color":"#ABABAB","time-slot-interval":15,"target-date":p.value,"data-intervals":d.value,"slot-class":h},null,8,["target-date","data-intervals"])])]))}});export{at as default};
